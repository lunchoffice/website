import{a as pt,b as Uo}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-5X4FSU5W.js";import{a as ye,b as mt}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-XN4XMZ3Y.js";import{a as re,b as De}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-XS7IOO33.js";import{Y as ut,ca as zo}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-6KY7HPWF.js";import{a as at,b as Bo}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-NVQSUXQM.js";import{a as ht,b as Ao}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-2DQTJCLI.js";import{e as yt,f as xt,h as No}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-CIUBNFL4.js";import{a as xe,b as Te,k as ft}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-OQ55FIGM.js";import{a as ct,b as Mo}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-K63NBZMV.js";import{a as dt,b as Do}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-CK3WTISR.js";import{a as _o}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-QIKJDD7D.js";import{b as be,c as gt}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-SJTMEUYS.js";import{a as ze}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-5H4U2CFA.js";import{a as l,d as z}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-4OGNP2SE.js";import{q as nt,r as Io}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-FXYSYPKH.js";import{a as ce,b as S,c as W,e as N}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-4V3WR64N.js";import{k as ge,l as Eo,r as st,v as j}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-A4DVYWQS.js";import{a as p,c as he,i as V}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-U5K4E52C.js";import{c as lt,d as Ro}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-WGBSCYQK.js";import{c as E}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-IH7B7A23.js";import{C as D,D as i,E as f,F as T}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-VKA7MXOG.js";import{a as M}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-372VUFQL.js";import{b as A,c as oe}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-WPBW27TF.js";import{a as P,b as Lo,d as R}from"https://st-p.rmcdn1.net/3233e0ca/dist/c/c-YGS3YKY6.js";function bt(e="idle"){let[t,o]=(0,Tt.useState)(e);return{status:t,setStatus:o,isIdle:t==="idle",isPending:t==="pending",isError:t==="error",isSuccess:t==="success"}}var Tt,wt=P(()=>{"use strict";Tt=R(M())});function we({src:e,onError:t}){let{isError:o,isPending:n,setStatus:a}=bt("pending"),s=(0,de.useRef)(new Set),d=(0,de.useRef)(new Set);return(0,de.useEffect)(function(){if(!e||s.current.has(e)||d.current.has(e))return;a("pending");let r=new Image;return r.src=e,r.onload=()=>{s.current.add(e),a("success")},r.onerror=()=>{d.current.add(e),a("error"),t?.()},function(){r.onload=null,r.onerror=null}},[e,t,a]),e?{isPending:n,isError:o}:{isPending:!1,isError:!1}}var de,_e=P(()=>{"use strict";de=R(M());wt()});var Ae,Tr,vt=P(()=>{"use strict";Ae={sidebarZindex:7100,sidebarWidth:"240px",popupZindex:9999,moveSpeed:"0.3s"},Tr={projectSettings:1,pageItem:1,footerButtons:2,helpPanel:3}});var Pt,Vo,Oo,St,Ct=P(()=>{"use strict";Pt=R(M());z();Do();vt();T();Vo=e=>{(0,Pt.useEffect)(()=>{let t=o=>{let n=o.target;n.tagName!=="INPUT"&&n.tagName!=="TEXTAREA"&&!n.isContentEditable&&e&&e(o)};return window.addEventListener("keydown",t,{capture:!0}),()=>{window.removeEventListener("keydown",t,{capture:!0})}},[e])},Oo=({children:e})=>(Vo(t=>{t.preventDefault(),t.stopPropagation()}),f(D,{children:[i(dt,{zIndex:Ae.popupZindex-1,backgroundColor:"black","data-testid":"fullscreen-modal-overlay"}),i(l,{display:"flex",position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:Ae.popupZindex+1,padding:"0",borderRadius:"0",flexDirection:"column",backgroundColor:"lightGray",overflow:"auto",children:e})]})),St=Oo});function Ir({userModel:e,children:t}){let[o,n]=(0,H.useState)(()=>e?{...e.attributes}:void 0);(0,H.useEffect)(()=>{function m(r){n(c=>({...c,...r.attributes}))}return e?.on("change",m),()=>{e?.off("change",m)}},[]);let a=(0,H.useCallback)(m=>{if(o){let r={...o.opts,...m};n({...o,opts:r}),e?.save({opts:r},{patch:!0,silent:!0})}},[e,o]),s=(0,H.useCallback)(m=>{e?.save({behavior_metrics:{...e.get("behavior_metrics")||{},...m}},{patch:!0,silent:!0})},[e]),d=!!(window?.RM?.constructorRouter?.isOwner&&nt.isFreePlan(o?.plan));return i(ve.Provider,{value:{user:o,isFreePlan:d,setUserOptions:a,setUserMetrics:s},children:t})}var H,ve,Br,Ft=P(()=>{"use strict";H=R(M());Io();T();ve=(0,H.createContext)({user:void 0,isFreePlan:!0,setUserOptions:()=>{},setUserMetrics:()=>{}});Br=()=>(0,H.useContext)(ve)});var kt,$o,Lt,It=P(()=>{"use strict";ft();kt=R(M());z();N();j();V();T();$o=({onClose:e})=>i(l,{as:"button",onClick:e,color:"white",background:"none",border:"none",fontSize:15,cursor:"pointer",paddingInline:0,css:E`
      &:hover {
        opacity: 0.7;
      }
    `,children:"\u2715"}),Lt=({message:e,open:t,onClose:o,duration:n=5e3})=>((0,kt.useEffect)(()=>{if(t){let a=setTimeout(o,n);return()=>clearTimeout(a)}},[t,n,o]),i(Te,{children:t&&i(xe.div,{initial:{y:-80,opacity:0},animate:{y:0,opacity:1},exit:{y:-80,opacity:0},transition:{type:"spring",bounce:0},style:{zIndex:9999},children:f(l,{position:"fixed",top:0,left:0,right:0,backgroundColor:p.blue,padding:"14px 40px",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:9999,children:[i(ce,{color:"white",textStyle:"small",fontWeight:"500",children:e}),i($o,{onClose:o})]})})}))});var Or,Pe,Ne=P(()=>{"use strict";Or=async(e,t)=>{let o=new FormData;return o.append("name",e),o.append("upload",t),await fetch("/api/upload",{headers:{"cache-control":"no-cache"},method:"post",body:o}).then(n=>n.json())},Pe=async(e,t)=>{let o=new FormData;return o.append("name",e),o.append("upload",t),await fetch("/api/upload/lambda",{headers:{"cache-control":"no-cache"},method:"post",body:o}).then(n=>n.json())}});var Ve,Bt,Et,Rt,Oe,Ut,Mt,$e=P(()=>{"use strict";Ke();Se();Ve=e=>Ce({screenshotUrl:e.screenshotUrl,usePhoneScreenshot:e.usePhoneScreenshot,useTabletScreenshot:e.useTabletScreenshot,viewport:e.viewport,imageSize:"large_plus"}),Bt=(e,t)=>{let o=t.map(n=>{let a={page:n._id,previews:{...n.screenshot&&{default:Ve({screenshotUrl:n.screenshot,viewport:"default"})},...n.viewport_phone_portrait?.screenshot&&{phone_portrait:Ve({screenshotUrl:n.viewport_phone_portrait.screenshot,usePhoneScreenshot:n.viewport_phone_portrait?.enabled||!1,viewport:"phone_portrait"})},...n.viewport_tablet_portrait?.screenshot&&{tablet_portrait:Ve({screenshotUrl:n.viewport_tablet_portrait.screenshot,useTabletScreenshot:n.viewport_tablet_portrait?.enabled||!1,viewport:"tablet_portrait"})}}},s=e.pages?.find(d=>String(d.page)===String(n._id));return s?{page:n._id,previews:{...a.previews,...s.previews}}:a});return{cover:e.cover,pages:o}},Et=(e,t,o,n)=>{let a=[...e.pages||[]],s=a.findIndex(d=>d.page?.toString()===t.toString());return s!==-1?a[s]={...a[s],previews:{...a[s].previews,[o]:n}}:a.push({page:t,previews:{[o]:n}}),{...e,pages:a}},Rt=(e,t)=>e.pages?.find(n=>n.page?.toString()===t.toString())?.previews,Oe=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},Ut=e=>{localStorage.removeItem(e)},Mt=e=>JSON.parse(localStorage.getItem(e)||"{}")});var Ho,Fe,He=P(()=>{"use strict";j();gt();V();T();Ho=({children:e,...t})=>i(be,{variant:"unstyled",display:"block",width:272,height:48,lineHeight:"48px",borderRadius:8,textStyle:"regular",cursor:"pointer",color:"white",transition:".1s ease-in",userSelect:"none",css:E`
        &:hover {
          opacity: ${t.backgroundColor===p.darkGray?1:.7};
        }
      `,...t,children:e}),Fe=Ho});var jo,Dt,zt=P(()=>{"use strict";z();N();He();V();T();jo=({onExit:e})=>i(l,{display:"flex",height:"100vh",alignItems:"center",justifyContent:"center",backgroundColor:p.lightGray,children:f(l,{width:"min(90vw, 775px)",height:"min(90vh, 441px)",minWidth:560,padding:24,backgroundColor:"white",borderRadius:8,display:"flex",flexDirection:"column",justifyContent:"space-between",children:[f(S,{fontSize:110,fontWeight:500,lineHeight:"91px",color:p.black,children:["Your template\u2019s",i("br",{}),"submitted"]}),f(l,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",gap:8,children:[f(S,{fontSize:24,fontWeight:400,color:p.black,lineHeight:"26px",children:["The review process usually takes 21 days.",i("br",{}),"Check your email for status updates."]}),i(Fe,{width:148,backgroundColor:p.blue,onClick:e,children:"Return to work"})]})]})}),Dt=jo});function je(e){try{let t=new URL(e.includes("://")?e:`https://${e}`);return/^(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}$/.test(t.hostname)?t.toString():!1}catch{return!1}}function Ge(e){try{let t=new URL(e.includes("://")?e:`https://${e}`),o=t.hostname.toLowerCase();return["shopify.com","gumroad.com","lemonsqueezy.com"].some(s=>o===s||o.endsWith(`.${s}`))?t.toString():!1}catch{return!1}}function We(e){let t=e.trim().toLowerCase();return/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(t)?t:!1}function qe(e){let t=e.trim().replace(",",".");return/^(\d+([.,]\d+)?|\d+[.,]?)$/.test(e.trim())&&!isNaN(Number(t))&&Number(t)>=0?Number(t):!1}var _t=P(()=>{"use strict"});var Nt=Lo((ke,At)=>{"use strict";(function(e,t){if(typeof define=="function"&&define.amd)define(["module","exports"],t);else if(typeof ke<"u")t(At,ke);else{var o={exports:{}};t(o,o.exports),e.autosize=o.exports}})(ke,function(e,t){"use strict";var o=typeof Map=="function"?new Map:function(){var r=[],c=[];return{has:function(g){return r.indexOf(g)>-1},get:function(g){return c[r.indexOf(g)]},set:function(g,x){r.indexOf(g)===-1&&(r.push(g),c.push(x))},delete:function(g){var x=r.indexOf(g);x>-1&&(r.splice(x,1),c.splice(x,1))}}}(),n=function(c){return new Event(c,{bubbles:!0})};try{new Event("test")}catch{n=function(y){var g=document.createEvent("Event");return g.initEvent(y,!0,!1),g}}function a(r){if(!r||!r.nodeName||r.nodeName!=="TEXTAREA"||o.has(r))return;var c=null,y=null,g=null;function x(){var h=window.getComputedStyle(r,null);h.resize==="vertical"?r.style.resize="none":h.resize==="both"&&(r.style.resize="horizontal"),h.boxSizing==="content-box"?c=-(parseFloat(h.paddingTop)+parseFloat(h.paddingBottom)):c=parseFloat(h.borderTopWidth)+parseFloat(h.borderBottomWidth),isNaN(c)&&(c=0),b()}function k(h){{var w=r.style.width;r.style.width="0px",r.offsetWidth,r.style.width=w}r.style.overflowY=h}function L(h){for(var w=[];h&&h.parentNode&&h.parentNode instanceof Element;)h.parentNode.scrollTop&&w.push({node:h.parentNode,scrollTop:h.parentNode.scrollTop}),h=h.parentNode;return w}function C(){if(r.scrollHeight!==0){var h=L(r),w=document.documentElement&&document.documentElement.scrollTop;r.style.height="",r.style.height=r.scrollHeight+c+"px",y=r.clientWidth,h.forEach(function(F){F.node.scrollTop=F.scrollTop}),w&&(document.documentElement.scrollTop=w)}}function b(){C();var h=Math.round(parseFloat(r.style.height)),w=window.getComputedStyle(r,null),F=w.boxSizing==="content-box"?Math.round(parseFloat(w.height)):r.offsetHeight;if(F<h?w.overflowY==="hidden"&&(k("scroll"),C(),F=w.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(r,null).height)):r.offsetHeight):w.overflowY!=="hidden"&&(k("hidden"),C(),F=w.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(r,null).height)):r.offsetHeight),g!==F){g=F;var Z=n("autosize:resized");try{r.dispatchEvent(Z)}catch{}}}var u=function(){r.clientWidth!==y&&b()},I=function(h){window.removeEventListener("resize",u,!1),r.removeEventListener("input",b,!1),r.removeEventListener("keyup",b,!1),r.removeEventListener("autosize:destroy",I,!1),r.removeEventListener("autosize:update",b,!1),Object.keys(h).forEach(function(w){r.style[w]=h[w]}),o.delete(r)}.bind(r,{height:r.style.height,resize:r.style.resize,overflowY:r.style.overflowY,overflowX:r.style.overflowX,wordWrap:r.style.wordWrap});r.addEventListener("autosize:destroy",I,!1),"onpropertychange"in r&&"oninput"in r&&r.addEventListener("keyup",b,!1),window.addEventListener("resize",u,!1),r.addEventListener("input",b,!1),r.addEventListener("autosize:update",b,!1),r.style.overflowX="hidden",r.style.wordWrap="break-word",o.set(r,{destroy:I,update:b}),x()}function s(r){var c=o.get(r);c&&c.destroy()}function d(r){var c=o.get(r);c&&c.update()}var m=null;typeof window>"u"||typeof window.getComputedStyle!="function"?(m=function(c){return c},m.destroy=function(r){return r},m.update=function(r){return r}):(m=function(c,y){return c&&Array.prototype.forEach.call(c.length?c:[c],function(g){return a(g,y)}),c},m.destroy=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],s),r},m.update=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],d),r}),t.default=m,e.exports=t.default})});var ue,Le,Go,Vt,Ot=P(()=>{"use strict";ue=R(M()),Le=R(Nt()),Go=()=>{let[e,t]=(0,ue.useState)(null);return(0,ue.useEffect)(()=>{if(e)return(0,Le.default)(e),()=>{e&&Le.default.destroy(e)}},[e]),(0,ue.useEffect)(()=>{e&&Le.default.update(e)}),t},Vt=Go});var $t,Wo,qo,Kt,G,Ze=P(()=>{"use strict";$t=R(M());j();Ot();Ro();N();T();Wo=st("textarea")`
  box-sizing: border-box;
  display: block;
  width: 100%;
  background: transparent;
  border: none;
  outline: none;
  resize: none;
  font-family: inherit;

  &::placeholder {
    color: ${({theme:e})=>e.colors.gray};
  }
`,qo=(0,$t.forwardRef)(({autoSize:e=!1,...t},o)=>{let n=Vt();return i(Wo,{ref:lt(o,e?n:null),...t})}),Kt=S.withComponent(qo);Kt.defaultProps={padding:0,textStyle:"regular",color:"black"};G=Kt});var Xe=P(()=>{"use strict";Ze();Ze()});var ie,ne,X,gi,hi,Ht,yi,xi,jt=P(()=>{"use strict";ie={CompanyWebsite:"company-website",Portfolio:"portfolio",Presentation:"presentation",Editorial:"editorial",LandingPage:"landing-page",ECommerce:"e-commerce"},ne={CompanyWebsite:"company website",Portfolio:"portfolio",Presentation:"presentation",Editorial:"editorial",LandingPage:"landing page",ECommerce:"ecommerce"},X={company_website:{title:"Company website",color:"#8C8C8C",activeTextColor:"white",path:ie.CompanyWebsite,type:ne.CompanyWebsite},photo_stories:{title:"Landing page",color:"#FFCB00",activeTextColor:"white",path:ie.LandingPage,type:ne.LandingPage},presentations:{title:"Presentation",color:"#408D27",activeTextColor:"white",path:ie.Presentation,type:ne.Presentation},microsites:{title:"Portfolio",color:"#FF7CBE",activeTextColor:"white",path:ie.Portfolio,type:ne.Portfolio},longreads:{title:"Editorial",color:"#0080FF",activeTextColor:"white",path:ie.Editorial,type:ne.Editorial},e_commerce:{title:"Online store",color:"#8E0D99",activeTextColor:"white",path:ie.ECommerce,type:ne.ECommerce}},gi=e=>X[e]?.path||"",hi=e=>Object.entries(X).find(([,t])=>t.path===e)?.[0],Ht=e=>X[e]?.title||"",yi=e=>X[e]?.color||"#032BFF",xi=e=>X[e]?.activeTextColor||"white"});var Zo,Gt,Wt=P(()=>{"use strict";z();N();j();jt();V();T();Zo=({color:e,selectedTags:t,onChange:o})=>f(D,{children:[i(l,{paddingLeft:8,children:i(S,{textStyle:"small",color:e,children:"Choose primary tags"})}),i(l,{display:"flex",flexWrap:"wrap",gap:3,marginTop:4,children:Object.keys(X).map(n=>i(l,{backgroundColor:t.includes(n)?"#CCE6FF":p.lightGray,color:t.includes(n)?p.blue:p.black,padding:"3px 8px",display:"flex",alignItems:"center",height:24,borderRadius:8,cursor:"pointer",onClick:()=>{let a=[];t.includes(n)?a=t.filter(s=>s!==n):a=[...t,n],o(a)},css:E`
              &:hover {
                opacity: 0.7;
              }
            `,children:i(S,{textStyle:"small",children:Ht(n)})},n))})]}),Gt=Zo});var ae,Xo,qt,Zt=P(()=>{"use strict";ae=R(M());z();V();Ao();T();Xo=({width:e,selected:t,values:o,captions:n,onChange:a,margin:s,height:d=40,borderRadius:m=8,bgColor:r=p.gray,hoverColor:c=p.darkGray,activeHoverColor:y=p.red,activeColor:g=p.black})=>{let[x,k]=(0,ae.useState)(t),[L,C]=(0,ae.useState)(null),[b,u]=(0,ae.useState)(!1);return(0,ae.useEffect)(()=>{k(t)},[t]),f(l,{display:"flex",position:"relative",width:e,height:d,backgroundColor:!L||b||L===x?r:c,borderRadius:m,justifyContent:"space-between",cursor:"pointer",margin:s,children:[i(ht,{as:"select",value:t,onChange:I=>{a(I.currentTarget&&I.currentTarget.value===o[0]?o[0]:o[1])}}),i(l,{position:"absolute",width:e/2,height:d,borderRadius:m,padding:12,transform:`translateX(${x===o[0]?"0px":`${e/2}px`})`,transition:"transform 0.2s ease-in-out",backgroundColor:L===x&&!b?y:g}),i(l,{display:"flex",position:"absolute",left:0,alignItems:"center",justifyContent:"center",width:e/2,height:d,borderRadius:m,padding:12,onMouseEnter:()=>{C(o[0])},onMouseLeave:()=>{u(!1),C(null)},onClick:()=>{u(!0),k(o[0]),a(o[0])},children:n[0]}),i(l,{display:"flex",position:"absolute",right:0,alignItems:"center",justifyContent:"center",width:e/2,height:d,borderRadius:m,padding:12,onMouseEnter:()=>{C(o[1])},onMouseLeave:()=>{u(!1),C(null)},onClick:()=>{u(!0),k(o[1]),a(o[1])},children:n[1]})]})},qt=Xo});function Yo({text:e,href:t,width:o=160,height:n,padding:a="12px 16px",boxPosition:s,arrowPosition:d,onClick:m,variant:r="default",forceShow:c,whiteSpace:y,triggerSize:g=24,...x}){let k=(0,Y.useRef)(null),L=(0,Y.useRef)(null),[C,b]=(0,Y.useState)(!!c),u=r==="white";return(0,Y.useEffect)(()=>()=>{L.current&&clearTimeout(L.current)},[]),f(l,{position:"relative",width:g,height:g,minWidth:g,onMouseEnter:()=>{L.current&&(clearTimeout(L.current),L.current=null),b(!0)},onMouseLeave:()=>{L.current=setTimeout(()=>{b(!1)},300)},...x,children:[i(l,{as:t?"a":void 0,href:t,target:t?"_blank":void 0,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid",borderColor:ge(.92,p.black),borderRadius:"50%",width:g,height:g,lineHeight:g,cursor:"pointer",onClick:()=>m&&m(),backgroundColor:p.gray,textDecoration:"none",css:E`
          &:hover {
            background: ${u?p.white:ge(.04,p.darkGray)};
            & > * {
              color: ${u?p.gray:p.white};
              cursor: inherit;
            }
          }
        `,children:i(S,{textStyle:"small",color:"white",cursor:"default",children:"?"})}),e?i(Te,{children:C?i(xe.div,{style:{position:"absolute",bottom:"100%",left:0,pointerEvents:"auto"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:0},children:i(l,{position:"absolute",bottom:0,marginBottom:"12px",width:o,...s||{marginLeft:`${-parseInt(o?.toString()||"")/2+12}px`},children:f(yt,{height:"auto",padding:a,whiteSpace:y,color:u?"black":void 0,backgroundColor:u?"white":void 0,border:u?`1px solid ${ge(.92,p.black)}`:void 0,textAlign:"center",children:[e,i(xt,{ref:k,top:"100%",left:"50%",...d})]})})}):null}):null]})}var Y,Ie,Ye=P(()=>{"use strict";Y=R(M());Eo();ft();z();V();N();No();j();T();Ie=Yo});var se,Jo,Qo,Xt,Yt=P(()=>{"use strict";se=R(M());z();N();mt();oe();Ne();Qe();_e();De();V();Je();T();Jo=()=>i(l,{background:"transparent",position:"absolute",zIndex:99,display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",children:i(re,{color:"gray",bgColor:"transparent"})}),Qo=({previewImage:e,onAddImage:t,color:o=p.black})=>{let[n,a]=(0,se.useState)(!1),[s,d]=(0,se.useState)(!1),[m,r]=(0,se.useState)(null),{isPending:c,isError:y}=we({src:m||e,onError:()=>{console.warn("Image failed to load",m)}});(0,se.useEffect)(()=>{!c&&m&&(y||t(m),r(null),d(!1))},[c,y,m,t]);let g=async k=>{if(n&&a(!1),!s){if(k&&k.size>A.UPLOAD_IMAGE_SIZE_LIMIT){window.alert(A.MSG_UPLOAD_IMAGE_SIZE_ERROR);return}if(!le.includes(k.type)){window.alert("Only PNG and JPEG formats are supported.");return}d(!0);try{let L=await Pe("template-submission-cover",k),C=L.picture?.lambdaUrl||L.picture.url;C?r(C):window.alert("Loading image failed")}catch(L){console.error(L)}finally{d(!1)}}},x=e||m;return f(l,{width:"100%",height:"100%",userSelect:"none",onDragEnter:()=>{n||a(!0)},onDragLeaveCapture:()=>{n&&a(!1)},opacity:n?.5:1,position:"relative",children:[s&&i(Jo,{}),x?i(l,{width:"100%",height:"100%",userSelect:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:`url(${x})`,backgroundSize:"cover",backgroundPosition:"top",backgroundRepeat:"no-repeat",position:"relative",borderTopRightRadius:8,borderBottomRightRadius:8,children:i(Be,{id:"template-submission-replace-cover",onUpload:g,disabled:s})}):i(ye,{id:"template-submission-upload-cover",accept:le.join(","),dropFile:!0,readFileData:!1,disabled:s,onChange:g,children:i(l,{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",children:!s&&f(D,{children:[i(S,{fontWeight:100,fontSize:50,lineHeight:1.42,color:o,children:"+"}),i(S,{textStyle:"regular",lineHeight:1.75,color:o,children:"Upload your template preview"}),i(S,{textStyle:"small",color:o,children:"Recommended size: 1920 \xD7 1264"})]})})})]})},Xt=Qo});var pe,Jt,er,Qt,eo=P(()=>{"use strict";pe=R(M());Xe();z();N();V();T();Jt="Template name",er=(e,t)=>{let o=(0,pe.useRef)(null),[n,a]=(0,pe.useState)(0);return(0,pe.useEffect)(()=>{if(o.current){let s=o.current.offsetWidth;a(s)}},[]),f(l,{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",children:[i(G,{...e,name:"template-title-in-templates",placeholder:Jt,maxLength:20,rows:1,textStyle:"subheading",height:30}),!e.value&&i(l,{position:"absolute",left:n+6,top:7,right:-25,children:i(S,{textStyle:"small",color:t?p.red:p.gray,children:"(max. 20 symbols)"})}),i(l,{position:"absolute",visibility:"hidden",pointerEvents:"none",height:0,overflow:"hidden",children:i(S,{ref:o,textStyle:"subheading",children:Jt})})]})},Qt=er});var O,to,Ee=P(()=>{"use strict";_t();Xe();_o();z();N();Wt();Zt();Ye();Yt();eo();T();O={templateName:{initialValue:"",required:!0,componentType:"textarea",formatter:e=>e.trim(),component:Qt,removelineBreaks:!0},creatorName:{initialValue:"",required:!0,componentType:"textarea",formatter:e=>e.trim(),component:e=>i(G,{...e,name:"creator-name-in-templates",placeholder:"Creator's name",maxLength:30,rows:1,textStyle:"small"}),removelineBreaks:!0},portfolioLink:{initialValue:"",required:!0,validate:e=>!!je(e),errorMessage:"Add a valid link to Portfolio Link field.",formatter:e=>je(e),componentType:"input",component:e=>i(ze,{...e,name:"portfolio-link-in-templates",placeholder:"Portfolio link",maxLength:500,textStyle:"small"}),trim:!0,removelineBreaks:!0},contactLink:{initialValue:"",required:!0,validate:e=>!!We(e),errorMessage:"Add a valid email to Contact email field.",formatter:e=>We(e),componentType:"textarea",component:e=>i(G,{...e,name:"contact-link-in-templates",placeholder:"Contact e-mail",maxLength:100,rows:1,textStyle:"small"}),trim:!0,removelineBreaks:!0},templateDescription:{initialValue:"",required:!0,componentType:"textarea",formatter:e=>e.trim(),component:e=>i(G,{...e,name:"description-in-templates",placeholder:"Template description (max. 200 symbols)",maxLength:200,rows:7,textStyle:"small"})},selectedTags:{initialValue:[],required:!0,validate:(e,t)=>e.length>0&&(!t.customTags||!!t.customTags&&e.length>0),errorMessage:"Select a primary tag along with your custom tag.",componentType:"tags",component:e=>i(Gt,{...e})},customTags:{initialValue:"",componentType:"textarea",formatter:e=>e.trim(),component:e=>i(G,{...e,name:"custom-tag-in-templates",placeholder:"Custom tag (optional)",maxLength:100,rows:1,textStyle:"small"}),removelineBreaks:!0},isPaid:{initialValue:!1,componentType:"toggle",component:e=>i(qt,{...e}),toggleConfig:{toggleValues:[{label:"Free",value:"free"},{label:"Paid",value:"paid"}],toggleTrueValue:"paid"}},price:{initialValue:"",required:({isPaid:e})=>e,validate:(e,t)=>{if(!t.isPaid)return!0;let o=qe(e);return!!(o&&o>1&&o<1e4)},errorMessage:"Set a price higher than $1 and less than $10000.",formatter:e=>qe(e),componentType:"textarea",component:e=>f(l,{display:"flex",flexDirection:"row",gap:8,children:[i(S,{textStyle:"small",children:"$"}),i(G,{...e,name:"price-in-templates",placeholder:"Price",maxLength:7,rows:1,textStyle:"small"})]}),trim:!0,twoDecimals:!0,removelineBreaks:!0},purchaseLink:{initialValue:"",required:({isPaid:e})=>e,validate:(e,t)=>t.isPaid?!!Ge(e):!0,errorMessage:"Add a valid link\u2014Shopify, Gumroad or Lemonsqeezy one\u2014to Purchase Link field.",formatter:e=>Ge(e),componentType:"input",component:e=>f(l,{display:"flex",width:"100%",justifyContent:"space-between",children:[i(ze,{...e,name:"purchase-link-in-templates",placeholder:"Purchase link",maxLength:500,textStyle:"small"}),i(Ie,{width:210,triggerSize:16,boxPosition:{marginLeft:"-169px"},arrowPosition:{left:"auto",right:4},text:"Add a link to an external marketplace (e.g. Lemon Squeezy, Gumroad, Shopify) where this template will be available for purchase."})]}),trim:!0,removelineBreaks:!0},previewImages:{initialValue:{},required:!0,validate:e=>!!e.cover?.default,componentType:"image",component:e=>i(Xt,{...e})}},to=e=>{let t={};return Object.keys(O).forEach(o=>{let n=O[o],a=e[o],s=n.formatter?.(a)??a;t[o]=s===!1?a:s}),t}});var J,tr,oo,ro,io=P(()=>{"use strict";J=R(M());Ee();tr=e=>Object.keys(O).every(t=>{let o=O[t],n=e[t];return(typeof o.required=="function"?o.required(e):o.required)?o.validate?o.validate(n,e):Array.isArray(n)?n.length>0:typeof n=="object"&&n!==null?Object.keys(n).length>0:!!n:!0}),oo=e=>{let[t,o]=(0,J.useState)(e),[n,a]=(0,J.useState)([]),[s,d]=(0,J.useState)(""),m=(0,J.useCallback)((y,g)=>{o(x=>({...x,[y]:g}))},[]),r=(0,J.useCallback)((y=[],g={})=>{let x=n;d("");let k="";return(y.length>0?y:Object.keys(O)).forEach(C=>{x=x.filter(F=>F!==C);let b=O[C],u=g[C]??t[C];if(!(typeof b.required=="function"?b.required(t):b.required))return;if(!(Array.isArray(u)?u.length>0:!!u)){x.push(C);return}(b.validate?b.validate(u,t):!0)||(x.push(C),O[C].errorMessage&&(k=O[C].errorMessage||""))}),a(x),k&&d(k),x.length===0},[t,n]),c=tr(t);return{form:t,setForm:o,updateField:m,validateForm:r,errors:n,setErrors:a,isFormFilled:c,errorMessage:s}},ro=()=>Object.fromEntries(Object.entries(O).map(([e,t])=>[e,t.initialValue]))});var Dn,zn,_n,An,Nn,Vn,On,no,ao=P(()=>{"use strict";oe();Dn=e=>e.is_published?e.changed?"unpublishedChanges":"sameAsPublished":"unpublished",zn=(e,t=!1)=>{let o=A.readymag_viewer_host,n=o.split("//")[1],a=e.domain,s=e.user.domain,d=t?`${o.split("//")[0]}//`:"",m=a||s||`${n}/${e.user.uri}`;return d+m},_n=e=>{let t=A.readymag_viewer_host;return e.domain?e.domain:`${t}/${e.uri}`},An=e=>/[^\x00-\x7f]/.test(e)?e.replace(/[^\x00-\x7f]/g,""):e,Nn=e=>/\s/.test(e)?e.replace(/\s/g,""):e,Vn=e=>{let t=e.trim();return t=t.replace(/^\/\//,""),t=t.replace(/^[A-Za-z]+?:\/\//,""),t=t.replace(/\/.*$/,""),t=t.replace(/:\d*$/,""),t=t.replace(/^.*?@/,""),t=t.trim(),t},On=e=>{let t="",o="",n="";return e&&(e.arecord&&(t="A-record",o=e.usedArecord||o,n=e.validArecord||n),e.cname&&(t="CNAME-record",o=e.usedCname||o,n=e.validCname&&e.validCname+"."||n)),{domain:e.domain,subdomain:e.subdomain,recordType:t,currentValue:o,neededValue:n}},no=(e,t="")=>e.replace(/(\r?\n|\r)+/g,t)});var so,lo=P(()=>{"use strict";j();N();Ee();ao();V();T();so=(e,{form:t,errors:o,setErrors:n,updateField:a,validate:s,onBlur:d,onAddImage:m})=>{let{key:r,disabled:c=!1}=e,y=O[r],g=o.includes(r),x=t[r];if(!y.component)return null;let k={key:r,translate:"no",spellCheck:!1,value:x,color:g?p.red:p.black,disabled:c,onBlur:()=>{s([r]),d()}},L=b=>{n(o.filter(I=>I!==r));let u=String(b);if(y.removelineBreaks&&(u=no(u)),y.trim&&(u=u.trim()),y.twoDecimals){u=u.replace(",","."),u=u.replace(/[^0-9.]/g,"");let I=u.split(".");I.length>2&&(u=I[0]+"."+I.slice(1).join("").replace(/\./g,""));let[h,w]=u.split(".");w!==void 0&&(u=h+"."+w.slice(0,2))}a(r,u)},C=g?`
    ::placeholder {
      color: ${p.red};
    }
  `:"";switch(y.componentType){case"textarea":{let b={...k,autoSize:!0,onChange:u=>L(u.currentTarget.value),css:E`
          ${C}
        `};return y.component(b,g)}case"input":{let b={...k,border:"none !important",padding:0,onChange:u=>L(u.currentTarget.value),css:E`
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          resize: none;
          &:disabled {
            color: ${g?p.red:p.black};
            -webkit-text-fill-color: ${g?p.red:p.black};
            opacity: 1;
          }
          ${C}
        `};return y.component(b,g)}case"tags":{let b={color:g?p.red:p.darkGray,selectedTags:x,onChange:u=>{a(r,u),s([r],{[r]:u})}};return y.component(b,g)}case"toggle":{let b=y.toggleConfig,{toggleValues:u,toggleTrueValue:I}=b,h=x?I:u.find(F=>F.value!==I)?.value||void 0,w={width:168,height:24,selected:h,values:u.map(F=>F.value),captions:u.map(F=>i(S,{textStyle:"small",color:F.value===h?p.blue:p.black,userSelect:"none",children:F.label},F.value)),onChange:F=>{a(r,F===I)},bgColor:p.lightGray,hoverColor:`${p.lightGray}B3`,activeHoverColor:"#CCE6FFB3",activeColor:"#CCE6FF"};return y.component(w,g)}case"image":{let b={previewImage:x.cover?.default??null,onAddImage:u=>m({imageStr:u,key:"cover"}),color:k.color};return y.component(b,g)}default:return null}}});var fe,or,po,mo=P(()=>{"use strict";fe=R(M());V();N();z();j();lo();Ye();oe();T();or=({form:e,errors:t,setErrors:o,updateField:n,onBlur:a,isCreatorProfileDisabled:s,validate:d,onAddImage:m})=>{let r=c=>so(c,{form:e,errors:t,setErrors:o,updateField:n,validate:d,onAddImage:m,onBlur:a});return(0,fe.useEffect)(()=>{e.isPaid||o(t.filter(c=>c!=="price"&&c!=="purchaseLink"))},[e.isPaid,o]),f(l,{display:"flex",border:`1px solid ${he.transparentGrey}`,borderRadius:8,minWidth:1150,width:"100%",aspectRatio:1422/672,maxWidth:1333,children:[f(l,{width:"28%",padding:32,backgroundColor:"white",outline:"1px solid white",borderTopLeftRadius:8,borderBottomLeftRadius:8,flexShrink:0,children:[i(l,{paddingLeft:8,paddingTop:7,position:"relative",children:r({key:"templateName"})}),f(l,{gap:4,paddingLeft:8,display:"flex",flexDirection:"column",children:[i(l,{gap:3,display:"flex",flexDirection:"column",children:s?f(D,{children:[i(ce,{textStyle:"small",color:p.black,children:e.creatorName}),f(l,{display:"flex",width:"100%",justifyContent:"space-between",children:[i(W,{textStyle:"small",color:p.black,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",href:e.portfolioLink,target:"_blank",children:e.portfolioLink}),i(Ie,{width:145,triggerSize:16,boxPosition:{marginLeft:"-120px"},arrowPosition:{left:"auto",right:4},text:f(ce,{textStyle:"small",children:["To change personal information ",i(W,{color:"white",textDecoration:"underline",href:`mailto:${A.SUPPORT_MAIL}`,css:E`
                            &:hover {
                              color: ${p.lightGray};
                              text-decoration: none;
                            }
                          `,children:"contact Readymag support."})]})})]}),i(W,{textStyle:"small",color:p.black,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",href:`mailto:${e.contactLink}`,children:e.contactLink})]}):i(D,{children:["creatorName","portfolioLink","contactLink"].map(c=>i(fe.Fragment,{children:r({key:c})},c))})}),i(l,{paddingTop:4,position:"relative",children:r({key:"templateDescription"})})]}),r({key:"selectedTags"}),i(l,{paddingLeft:8,paddingTop:16,paddingBottom:32,children:r({key:"customTags"})}),r({key:"isPaid"}),e.isPaid&&i(l,{display:"flex",paddingLeft:8,paddingTop:16,gap:14,flexDirection:"column",children:["price","purchaseLink"].map(c=>i(fe.Fragment,{children:r({key:c})},c))})]}),r({key:"previewImages"})]})},po=or});var rr,co,uo=P(()=>{"use strict";z();$e();Se();N();V();T();rr=({data:e,previewImages:t,onAddImage:o,isLoadingDefault:n,isLoadingMobile:a,onReset:s})=>{let d=e.viewport_phone_portrait?.enabled?"phone_portrait":void 0,m=Rt(t,e._id);return f(l,{display:"flex",flexDirection:"column",children:[f(l,{display:"flex",flexDirection:"row",gap:8,children:[i(et,{borderRadius:8,imageSize:"large_plus",desktopUrl:m?.default||e.screenshot,viewport:"default",replacePreviewButton:{id:`template-submission-upload-cover-${e._id}-default`,onUpload:r=>o({fileSrc:r,key:e._id,viewport:"default"}),showReset:!!m?.default,onReset:()=>s("default")},cropTop:!0,skipSuffixCheck:!!m?.default,isLoading:n}),d&&i(et,{borderRadius:8,imageSize:"large_plus",phonePortraitUrl:m?.phone_portrait||e.viewport_phone_portrait?.screenshot,phoneViewportEnabled:e.viewport_phone_portrait?.enabled,viewport:d,replacePreviewButton:{id:`template-submission-upload-cover-${e._id}-${d}`,onUpload:r=>o({fileSrc:r,key:e._id,viewport:d}),showReset:!!m?.phone_portrait,onReset:()=>s("phone_portrait")},cropTop:!0,skipSuffixCheck:d==="phone_portrait"&&!!m?.phone_portrait,isLoading:a})]}),i(l,{paddingTop:8,children:i(S,{textStyle:"small",color:p.gray,children:`Page ${e.num}`})})]})},co=rr});var ir,fo,go=P(()=>{"use strict";z();N();uo();T();ir=({pagesTree:e,previewImages:t,onAddImage:o,loadingImages:n,onReset:a})=>f(l,{padding:"8px 0",width:"100%",maxWidth:1333,children:[i(l,{padding:"40px 0 20px 0",children:i(S,{textStyle:"subheading",children:"Pages"})}),i(l,{display:"flex",flexWrap:"wrap",columnGap:8,rowGap:"16px",paddingBottom:116,children:e.map((s,d)=>i(co,{data:s,previewImages:t,onAddImage:o,isLoadingDefault:n.includes(`${s._id}_default`),isLoadingMobile:n.includes(`${s._id}_phone_portrait`),onReset:m=>a(s._id,m)},d))})]}),fo=ir});var nr,ar,ho,yo=P(()=>{"use strict";j();z();gt();N();He();De();V();oe();T();nr=({setShowHint:e})=>i(l,{width:32,height:32,color:p.blue,transform:"rotate(45deg)",display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:7,right:21,onClick:()=>e(!1),cursor:"pointer",css:E`
      &:hover {
        opacity: 0.7;
      }
    `,children:i(S,{fontSize:28,fontWeight:200,marginLeft:1,marginBottom:5,children:"+"})}),ar=({onExit:e,showHint:t,setShowHint:o,onSubmit:n,isLoading:a,isFormFilled:s})=>f(l,{padding:"16px 40px",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:`1px solid ${he.transparentGrey}`,backgroundColor:p.lightGray,position:"fixed",height:80,bottom:0,width:"100vw",zIndex:999,children:[i(be,{color:p.darkGray,textStyle:"regular",onClick:e,children:"Cancel"}),t&&f(l,{flexGrow:1,display:"flex",justifyContent:"flex-end",paddingInline:16,position:"relative",children:[i(nr,{setShowHint:o}),i(l,{display:"flex",width:428,height:48,border:`1px solid ${p.blue}`,borderRadius:8,padding:"7px 15px",children:f(S,{textStyle:"small",color:p.blue,paddingRight:23,children:["Design and description can't be changed after submission. Reach out to ",i(W,{color:p.blue,textDecoration:"underline",href:`mailto:${A.SUPPORT_MAIL}`,children:"Readymag support"})," to request changes."]})})]}),i(Fe,{onClick:n,disabled:a,backgroundColor:s?p.blue:p.darkGray,minWidth:78,children:a?i(l,{display:"flex",justifyContent:"center",marginTop:-5,children:i(re,{bgColor:"transparent"})}):i(D,{children:"Submit"})})]}),ho=ar});var U,Re,sr,lr,le,pr,Xa,Je=P(()=>{"use strict";U=R(M());Mo();z();V();N();j();Ct();zo();Ft();It();Ne();oe();$e();zt();io();Ee();mo();go();yo();T();Re="unsavedTemplateSubmission_",sr=2e3,lr=30,le=["image/png","image/jpeg"],pr=({onExit:e,onSubmit:t,showHint:o,setShowHint:n})=>{let a=(0,U.useContext)(ut),d=(0,U.useContext)(ve).user?.creatorProfiles?.[0],m=ro(),{form:r,updateField:c,setForm:y,isFormFilled:g,errors:x,setErrors:k,validateForm:L,errorMessage:C}=oo({...m,creatorName:d?.creatorName||m.creatorName,portfolioLink:d?.portfolioLink||m.portfolioLink,contactLink:d?.contactLink||m.contactLink}),[b,u]=(0,U.useState)(!1),[I,h]=(0,U.useState)(!1),[w,F]=(0,U.useState)(""),[Z,Q]=(0,U.useState)(),[ee,te]=(0,U.useState)([]);(0,U.useEffect)(()=>{F(C)},[C]),(0,U.useEffect)(()=>{let v=Mt(`${Re}${a.project.num_id}`);y(B=>({...B,...v,...d?{creatorName:d.creatorName||"",portfolioLink:d.portfolioLink||"",contactLink:d.contactLink||""}:{creatorName:v.creatorName||"",portfolioLink:v.portfolioLink||"",contactLink:v.contactLink||""}}))},[d,a.project.num_id,y]),(0,U.useEffect)(()=>{Oe(`${Re}${a.project.num_id}`,r)},[r.selectedTags,r.previewImages,r.isPaid,a.project.num_id]);let wo=(0,U.useCallback)(()=>{Oe(`${Re}${a.project.num_id}`,r)},[r,a.project.num_id]),ot=async({fileSrc:v,key:B,imageStr:K,viewport:_})=>{if(B==="cover")c("previewImages",{...r.previewImages,cover:{default:K}}),k(x.filter($=>$!=="previewImages"));else{if(!v)return;try{te([...ee,`${B}_${_}`]);let $=await Pe("template-submission-cover",v),it=$.picture?.lambdaUrl?$.picture.lambdaUrl:$.picture.url;if(!it||!_){window.alert("Loading image failed");return}let Fo=Et(r.previewImages,B,_,it);c("previewImages",Fo),te(ee.filter(ko=>ko!==`${B}_${_}`))}catch($){console.error($)}}},vo=(v,B)=>{let K=(r.previewImages.pages||[]).map(_=>{if(_.page===v||_.copiedPageId===v){let $={..._.previews};return delete $[B],{..._,previews:$}}return _});c("previewImages",{...r.previewImages,pages:K})},Po=()=>{Z&&t(Z)},Ue=(0,U.useCallback)(async(v,B=0)=>{if(B>=lr)throw new Error("Submission processing timeout");await new Promise(_=>setTimeout(_,sr));let K=await a.getSubmissionStatus(v);return K==="processing"?Ue(v,B+1):K},[a]),rt=v=>{let B=[];for(let K of v)B.push(K),K.children&&(B=[...B,...rt(K.children)]);return B},Me=rt(a.pagesTree),So=(0,U.useCallback)(async()=>{if(!L()){r.customTags&&r.selectedTags.length===0&&F(O.selectedTags.errorMessage||w);return}h(!0);let v=to(r);try{d||await a.sendCreatorProfile({creatorName:v.creatorName,...v.portfolioLink&&{portfolioLink:v.portfolioLink},...v.contactLink&&{contactLink:v.contactLink}});let B=Bt(v.previewImages,Me),{submissionId:K,status:_}=await a.sendTemplateSubmission({primaryTags:v.selectedTags,...v.customTags&&{customTags:v.customTags},isPaid:v.isPaid,previewImages:B,templateName:v.templateName,templateDescription:v.templateDescription,...v.price&&{price:v.price},...v.purchaseLink&&{purchaseLink:v.purchaseLink}}),$=_;_==="processing"&&($=await Ue(K)),Q($),h(!1),u(!0),Ut(`${Re}${a.project.num_id}`)}catch(B){console.error("Error submitting tempate",B),F(f(D,{children:["Something's off. Please try again or contact ",i(W,{color:"white",textDecoration:"underline",href:`mailto:${A.SUPPORT_MAIL}`,css:E`
              &:hover {
                color: ${p.lightGray};
                text-decoration: none;
              }
            `,children:"Readymag support."})]})),h(!1)}},[r,L,d,Ue,a,Me,w]),{callback:Co}=ct(So,500);return f(St,{children:[i(Lt,{open:!!w,message:w,onClose:()=>F("")}),b?i(Dt,{onExit:Po}):f(D,{children:[f(l,{display:"flex",height:"100vh",flexDirection:"column",backgroundColor:p.lightGray,padding:40,alignItems:"center",minWidth:1230,children:[i(po,{form:r,errors:x,setErrors:k,updateField:c,onBlur:wo,isCreatorProfileDisabled:!!d,validate:L,onAddImage:ot}),i(fo,{pagesTree:Me,previewImages:r.previewImages,onAddImage:ot,loadingImages:ee,onReset:vo})]}),i(ho,{onExit:e,showHint:o,setShowHint:n,onSubmit:Co,isLoading:I,isFormFilled:g})]})]})},Xa=pr});var xo,Be,Qe=P(()=>{"use strict";xo=R(M());z();mt();N();j();oe();V();Je();T();Be=({onUpload:e,id:t,disabled:o,showReset:n=!1,onReset:a})=>{let[s,d]=(0,xo.useState)(!1),m=async r=>{if(!s){if(r&&r.size>A.UPLOAD_IMAGE_SIZE_LIMIT){window.alert(A.MSG_UPLOAD_IMAGE_SIZE_ERROR);return}if(!le.includes(r.type)){window.alert("Only PNG and JPEG formats are supported.");return}d(!0);try{await e(r)}catch(c){console.error(c)}finally{d(!1)}}};return f(l,{position:"absolute",bottom:8,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:4,justifyContent:"center",children:[i(l,{backgroundColor:p.darkGray,width:110,height:24,borderRadius:8,css:E`
          &:hover {
            opacity: 0.7;
          }
        `,children:i(l,{display:"flex",justifyContent:"center",alignItems:"center",children:i(ye,{id:t,accept:le.join(","),readFileData:!1,disabled:s||o,onChange:m,children:i(S,{color:"white",textStyle:"small",children:"Replace preview"})})})}),n&&a&&i(l,{backgroundColor:p.darkGray,width:110,height:24,borderRadius:8,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",onClick:a,css:E`
            &:hover {
              opacity: 0.7;
            }
          `,children:i(S,{color:"white",textStyle:"small",children:"Reset to default"})})]})}});var q,mr,me,et,Se=P(()=>{"use strict";q=R(M());z();Uo();De();_e();Ke();Qe();T();mr=()=>i(l,{background:"transparent",position:"absolute",zIndex:99,display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",children:i(re,{color:"gray",bgColor:"transparent"})}),me={small:{width:88,height:58},standard:{width:192,height:126},large:{width:420,height:276},large_plus:{width:439,height:289},mobile:{width:288,height:189},phone_portrait:{small:{width:33,height:58},standard:{width:71,height:126},large:{width:155,height:276},large_plus:{width:158,height:280},mobile:{width:288,height:511}},tablet_portrait:{small:{width:48,height:58},standard:{width:104,height:126},large:{width:229,height:276},large_plus:{width:232,height:280},mobile:{width:288,height:347}}},et=({desktopUrl:e,phonePortraitUrl:t,tabletPortraitUrl:o,phoneViewportEnabled:n,tabletViewportEnabled:a,opacity:s,blur:d=!1,viewport:m="default",imageSize:r="standard",customBox:c,borderRadius:y=4,cropTop:g=!1,replacePreviewButton:x,skipSuffixCheck:k,onLoadError:L,isLoading:C=!1})=>{let[b,u]=(0,q.useState)(null);(0,q.useEffect)(()=>{u(null)},[m]);let I=m==="phone_portrait"&&n,h=m==="tablet_portrait"&&a,w=(0,q.useMemo)(()=>{let te=I?t:h?o:e;return te?k?te:Ce({screenshotUrl:te,usePhoneScreenshot:I,useTabletScreenshot:h,viewport:m,imageSize:r}):null},[e,t,o,I,h,k,r,m]),{width:F,height:Z}=(0,q.useMemo)(()=>m==="default"?me[r]:r==="mobile"?me[m||"phone_portrait"][r]:To(h?"tablet_portrait":I?"phone_portrait":"default",me[r]),[r,I,h,m]),{isPending:Q,isError:ee}=we({src:w,onError:L});return(0,q.useEffect)(()=>{!Q&&!ee&&w&&u(w)},[Q,ee,w]),f(l,{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",children:[Q||C&&i(mr,{}),b?f(D,{children:[i(pt,{...c?{...c}:{width:F,height:Z},margin:"auto",borderRadius:`${y}px`,opacity:s!==void 0?s:1,filter:`blur(${d?"1px":0})`,display:"block",src:b,...g&&{objectFit:"cover",objectPosition:"top"}}),i(l,{width:"100%",height:"100%",position:"absolute",top:0,left:0})]}):i(l,{backgroundColor:"white",borderRadius:`${y}px`,...c?{...c}:{width:F,height:Z}}),x&&i(Be,{id:x.id,onUpload:x.onUpload,disabled:x.disabled,showReset:x.showReset,onReset:x.onReset})]})}});function cr(e,t){let o=e.split(".");return o.length>1?(o[o.length-2]+="_"+t,o.join(".")):e+"_"+t}function bs(e){let t=e.split(".");if(t.length>1){let o=t[t.length-2].split("_");if(o.length>1&&!isNaN(Number(o[o.length-1]))){o.pop();let n=o.join("_");return t[t.length-2]=n,t.join(".")}}return e}function dr(e){let t=e.split("."),o;return t.length>1&&(o=t[t.length-2].split("_")),o&&Array.isArray(o)&&o.length>1?o=o[o.length-1]:o=void 0,o}function ws(e,t="default"){let o=e*(window.devicePixelRatio>1?2:1),n=Object.values(tt[t])||[];return n.indexOf(o)===-1&&(o=n.filter(a=>a>o)[0]),n.indexOf(o)===-1?(console.error("Unknown screenshot size",e,"for viewport",t),bo):o}function fr(e,t="default"){return tt[t]?.[e]||bo}var bo,tt,ur,Ce,gr,To,Ke=P(()=>{"use strict";Bo();Se();bo=512,tt={default:{quarter:256,halfCover:608,half:512,cover:608,full:1024},phone_portrait:{half:160,full:320},tablet_portrait:{quarter:192,half:384,full:768}};ur=(e,t="default")=>{let o=tt[t],n=Object.entries(o).map(([a,s])=>[a,s]).sort((a,s)=>a[1]-s[1]);for(let[a,s]of n)if(s>=e)return a;return n[n.length-1][0]},Ce=e=>{let t=dr(e.screenshotUrl),o=e.viewport==="default"?me[e.imageSize]:me[e.viewport]?.[e.imageSize];if(!t||Number.isNaN(Number(t))){let n=e.usePhoneScreenshot?"phone_portrait":e.useTabletScreenshot?"tablet_portrait":"default",a=ur(o.width*2,n),s=fr(a,n);return cr(e.screenshotUrl,s)}return e.screenshotUrl};gr={default:{width:1024,height:672},phone_portrait:{width:320,height:568},tablet_portrait:{width:768,height:926}},To=(e,t)=>{let o=gr[e||"default"],n=t?at.getScaleToFit(o,t):1;return{width:o.width*n,height:o.height*n}}});export{bt as a,wt as b,Ae as c,Tr as d,vt as e,ve as f,Ir as g,Br as h,Ft as i,Or as j,Pe as k,Ne as l,Ge as m,_t as n,G as o,Xe as p,X as q,gi as r,hi as s,Ht as t,yi as u,xi as v,jt as w,qt as x,Zt as y,Ie as z,Ye as A,Dn as B,zn as C,_n as D,An as E,Nn as F,Vn as G,On as H,no as I,ao as J,Xa as K,Je as L,me as M,et as N,Se as O,cr as P,bs as Q,dr as R,ws as S,fr as T,gr as U,To as V,Ke as W};
